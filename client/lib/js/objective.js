var objective=function(e,i,t,s,n,a){this.img=null,this.name="",this.id=Math.random().toString(36).substr(2),this.gravity=!0,this.position=new game.canvas.vector(0,0),this.width=0,this.height=0,this.bounds={},this.extra={},this.life=0,this.ethereal=!0,this.visible=!1,this.movable=!0,this.grounded=!1,this.creature=!1,this.touched=!1,this.enemyVelocity=3,this.velX=0,this.velY=0,this.speed=3,this.self=this,this.floor=!1,this.limitWall=!1,this.status=null,this.orientation=null,this.objectives=null,this.interactive=!1,this.counter=0,this.currentFrame=0,this.totalFrames=0,this.dialog="",this.actualDialog="",this.finish=!1,this.answers=[],this.answered=!1,this.selectedAnswer=null,this.pendingAnswer=!1,this.dependOn=null,this.frameSpeed=3,this.isCinematic=!1,this.cinematicAction=null,this.cinematicData=null,this.dialogData={bckg:!0,bcgColor:"rgba(0,0,0,0.2)",dialog:{font:"bolder 20px Arial",color:"#FFF",x:20,y:80},answer:{font:"bolder 14px Arial",color:"#EEE",selectionColor:"#FF0000"}},this.instant=!1,this.create=function(e,i,t,s,n,a){"undefined"!=typeof e&&null!=e&&(this.img=e),"undefined"!=typeof i&&(this.gravity=i),"undefined"!=typeof t&&t instanceof game.canvas.vector&&(this.position=t),"undefined"!=typeof s&&(this.width=s),"undefined"!=typeof n&&(this.height=n),"undefined"!=typeof a&&(this.ethereal=a.ethereal,"undefined"!=typeof a.movable&&(this.movable=a.movable),"undefined"!=typeof a.floor&&(this.floor=a.floor),"undefined"!=typeof a.name&&(this.name=a.name),"undefined"!=typeof a.limitWall&&(this.limitWall=a.limitWall),"undefined"!=typeof a.creature&&(this.creature=a.creature),"undefined"!=typeof a.life&&(this.life=a.life),"undefined"!=typeof a.visible?this.visible=a.visible:this.visible=!0,"undefined"!=typeof a.enemyVelocity&&(this.enemyVelocity=a.enemyVelocity),"undefined"!=typeof a.objectives&&(this.objectives=a.objectives),"undefined"!=typeof a.frameSpeed&&(this.frameSpeed=a.frameSpeed),"undefined"!=typeof a.dialog&&(this.dialog=a.dialog),"undefined"!=typeof a.dependOn&&(this.dependOn=a.dependOn),"undefined"!=typeof a.answers&&(this.answers=a.answers,this.selectedAnswer=0),"undefined"!=typeof a.dialogData&&(this.dialogData=a.dialogData),"undefined"!=typeof a.isCinematic&&(this.isCinematic=a.isCinematic),"function"==typeof a.cinematicAction&&(this.cinematicAction=a.cinematicAction),"undefined"!=typeof a.cinematicData&&(this.cinematicData=a.cinematicData),"undefined"!=typeof a.instant&&(this.instant=a.instant))},this.update=function(){this.isCinematic===!0?this.updateCinematic():this.updateDialog()},this.updateDialog=function(){this.counter==this.frameSpeed-1&&""!=this.dialog&&(this.actualDialog+=this.dialog.slice(0,1),this.dialog=this.dialog.substr(1)),""==this.dialog&&this.pendingAnswer===!1&&(this.answers.length>0&&this.answered&&(this.finish=!0),0==this.answers.length&&(this.finish=!0)),this.counter=(this.counter+1)%this.frameSpeed},this.updateCinematic=function(){return"function"==typeof this.cinematicAction&&(input.clearKeys(),this.counter==this.frameSpeed-1&&this.cinematicAction(),void(this.counter=(this.counter+1)%this.frameSpeed))},this.animate=function(e){this.movement(e)},this.movement=function(e){game.centered>0&&(this.self.position.x+=this.self.velX-game.centerVelocity)},this.colliding=function(){for(var e=0;e<game.objects.length;e++)if(!game.objects[e].ethereal&&this.self.id!=game.objects[e].id&&!game.objects[e].limitWall){var i=game.colCheck(this.self,game.objects[e]);"l"===i||"r"===i?this.self.velX=0:"b"===i?this.self.grounded=!0:"t"===i&&(this.self.velY*=-1)}},this.doObjectives=function(){if(game.pauseInput=!0,game.cinematics=!0,game.pauseInput||this.finish||game.players[0].clearStatus(),this.finish?(input.clearKeys(),this.finish=!0,null!=this.selectedAnswer&&0!=this.answers[this.selectedAnswer].goto&&this.answers[this.selectedAnswer].goto(),null!=this.objectives&&this.objectives(),game.pauseInput=!1,game.cinematics=!1,game.activeObjective===this.self.id&&(game.activeObjective=null)):this.update(),this.dialogData.bckg===!0&&""!=this.actualDialog&&game.canvas.fillRect(new game.canvas.vector(this.dialogData.dialog.x-10,this.dialogData.dialog.y-25),30+30*this.answers.length,600,{color:this.dialogData.bcgColor}),game.canvas.drawText(this.actualDialog,{color:this.dialogData.dialog.color,x:this.dialogData.dialog.x,y:this.dialogData.dialog.y,font:this.dialogData.dialog.font}),""==this.dialog)for(var e=0;e<this.answers.length;e++)e==this.selectedAnswer?game.canvas.drawText(this.answers[e].dialog,{color:this.dialogData.answer.selectionColor,x:20,y:120+20*e,font:this.dialogData.answer.font}):game.canvas.drawText(this.answers[e].dialog,{color:this.dialogData.answer.color,x:20,y:120+20*e,font:this.dialogData.answer.font});this.chooseAnswer();var i;i=game.isMobile()?input.move.attack:input.key_code[13],i===!0&&(this.finish=!0,game.pauseInput=!1,input.clearKeys())},this.chooseAnswer=function(){if(0==this.answers.length)return!1;if(input.move.up||input.move.down)for(var e=0;e<this.answers.length;e++)if(e==this.selectedAnswer){if(input.move.down===!0)return e+1<this.answers.length?this.selectedAnswer=e+1:this.selectedAnswer=0,input.clearKeys(),!0;if(input.move.up)return 0==e?this.selectedAnswer=this.answers.length-1:this.selectedAnswer=e-1,input.clearKeys(),!0}},this.create(e,i,t,s,n,a),this.instant===!0&&(game.activeObjective=this.id)},dialogClass=function(){this.isInteractive=!1,this.answers=[],this.init=function(){},this.nextSecuence=function(){}};